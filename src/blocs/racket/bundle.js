(function(e){function t(o){if(n[o])return n[o].exports;var a=n[o]={exports:{},id:o,loaded:!1};return e[o].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)})([function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}var a=n(1),c=o(a);e.exports=c.default},function(module,exports,__webpack_require__){"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function removeChildren(e){for(;e.firstChild;)e.removeChild(e.firstChild)}Object.defineProperty(exports,"__esModule",{value:!0});var _slicedToArray=function(){function e(e,t){var n=[],o=!0,a=!1,c=void 0;try{for(var i,r=e[Symbol.iterator]();!(o=(i=r.next()).done)&&(n.push(i.value),!t||n.length!==t);o=!0);}catch(e){a=!0,c=e}finally{try{!o&&r.return&&r.return()}finally{if(a)throw c}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),template=__webpack_require__(2),Racket=function(){function Racket(document,audioContext){_classCallCheck(this,Racket);var outputNode=audioContext.createGain();this.inputs={},this.outputs={audio:{type:"audio",node:outputNode}};var tmpElem=document.createElement("div");tmpElem.innerHTML=template,this.windowView=tmpElem.childNodes[0];var blocContainerElem=this.windowView.querySelector(".bloc-container"),patchInputSelectElem=this.windowView.querySelector(".patch-input-select"),patchOutputSelectElem=this.windowView.querySelector(".patch-output-select"),patchConnectButtonElem=this.windowView.querySelector(".patch-connect-button"),patchConnectionListElem=this.windowView.querySelector(".patch-connection-list"),rackAudioOutPseudoBloc={inputs:{audio:{type:"audio",node:outputNode}}},nextBlocIdNum=1,blocInfo={ro:{id:"ro",code:null,_class:null,instance:rackAudioOutPseudoBloc,displayName:"RACK OUTPUT"}},nextCxnIdNum=1,cxnInfo={},updatePatchConnectionList=function(){removeChildren(patchConnectionListElem);var e=function(e){var t=cxnInfo[e],n=blocInfo[t.outBlocId].displayName+":"+t.outPortName+" â†’ "+blocInfo[t.inBlocId].displayName+":"+t.inPortName,o=document.createElement("li");o.appendChild(document.createTextNode(n+" "));var a=document.createElement("button");a.textContent="remove",a.addEventListener("click",function(){removeConnection(e)}),o.appendChild(a),patchConnectionListElem.appendChild(o)};for(var t in cxnInfo)e(t)},isValidConnection=function(e){var t=e.outBlocId,n=e.outPortName,o=e.inBlocId,a=e.inPortName,c=blocInfo[t].instance,i=blocInfo[o].instance;if(!c.outputs.hasOwnProperty(n))return!1;if(!i.inputs.hasOwnProperty(a))return!1;for(var r in cxnInfo){var l=cxnInfo[r];if(l.outBlocId===t&&l.outPortName===n&&l.inBlocId===o&&l.inPortName===a)return!1}return c.outputs[n].type===i.inputs[a].type},parseConnectionSpec=function(){var e=patchInputSelectElem.value,t=patchOutputSelectElem.value;if(!e||!t)return null;var n=e.split(":"),o=_slicedToArray(n,2),a=o[0],c=o[1],i=t.split(":"),r=_slicedToArray(i,2),l=r[0],d=r[1];return{inBlocId:a,inPortName:c,outBlocId:l,outPortName:d}},updatePatchConnectionValidity=function(){var e=parseConnectionSpec();patchConnectButtonElem.disabled=!(e&&isValidConnection(e))};updatePatchConnectionValidity();var updatePatchConnectOptions=function(){var e={},t={};for(var n in blocInfo){var o=blocInfo[n].instance,a=blocInfo[n].displayName;for(var c in o.inputs)e[n+":"+c]=a+":"+c;for(var i in o.outputs)t[n+":"+i]=a+":"+i}removeChildren(patchInputSelectElem);for(var r in e){var l=document.createElement("option");l.textContent=e[r]+" IN",l.value=r,patchInputSelectElem.appendChild(l)}removeChildren(patchOutputSelectElem);for(var d in t){var l=document.createElement("option");l.textContent=t[d]+" OUT",l.value=d,patchOutputSelectElem.appendChild(l)}updatePatchConnectionValidity()};updatePatchConnectOptions();var uniquifyDisplayName=function(e){var t=blocInfo[e].displayName,n={};for(var o in blocInfo)o!==e&&(n[blocInfo[o].displayName]=null);if(n.hasOwnProperty(t))for(var a=2;;a++){var c=t+" "+a;if(!n.hasOwnProperty(c))return void(blocInfo[e].displayName=c)}},addBloc=function addBloc(code){var bid="b"+nextBlocIdNum;nextBlocIdNum++;var blocClass=eval(code),blocInst=new blocClass(document,audioContext);blocInfo[bid]={id:bid,code:code,_class:blocClass,instance:blocInst,displayName:blocClass.blocName,wrapperElem:void 0},uniquifyDisplayName(bid);var wrapperElem=document.createElement("div");wrapperElem.style="margin: 1px",wrapperElem.setAttribute("data-blocid",bid);var headerElem=document.createElement("div");headerElem.style="background-color: #555; font-size: 12px; padding: 4px 6px; color: #ccc";var removeBlocElem=document.createElement("a");if(removeBlocElem.style="float:right;color: #ccc;text-decoration: none",removeBlocElem.href="#",removeBlocElem.textContent="X",removeBlocElem.addEventListener("click",function(e){e.preventDefault(),removeBloc(bid)}),headerElem.appendChild(removeBlocElem),headerElem.appendChild(document.createTextNode(blocInfo[bid].displayName)),wrapperElem.appendChild(headerElem),blocInst.panelView)wrapperElem.appendChild(blocInst.panelView);else{var placeholderElem=document.createElement("div");placeholderElem.innerHTML='<div style="box-sizing:border-box;width:62px;height:256px;text-align:center;font-size:14px;background:white;font-style:italic;color:gray;padding:100px 5px">No panel view</div>',wrapperElem.appendChild(placeholderElem)}blocContainerElem.appendChild(wrapperElem),blocInfo[bid].wrapperElem=wrapperElem,updatePatchConnectOptions()},removeBloc=function(e){var t=[];for(var n in cxnInfo){var o=cxnInfo[n];o.outBlocId!==e&&o.inBlocId!==e||t.push(n)}var a=!0,c=!1,i=void 0;try{for(var r,l=t[Symbol.iterator]();!(a=(r=l.next()).done);a=!0){var d=r.value;removeConnection(d)}}catch(e){c=!0,i=e}finally{try{!a&&l.return&&l.return()}finally{if(c)throw i}}blocContainerElem.removeChild(blocInfo[e].wrapperElem);var u=blocInfo[e].instance;u.deactivate&&u.deactivate(),delete blocInfo[e],updatePatchConnectOptions()},addConnection=function(e){var t=e.outBlocId,n=e.outPortName,o=e.inBlocId,a=e.inPortName,c="c"+nextCxnIdNum;nextCxnIdNum++;var i={outBlocId:t,outPortName:n,inBlocId:o,inPortName:a,disconnect:void 0};cxnInfo[c]=i;var r=blocInfo[t].instance,l=blocInfo[o].instance;(function(){switch(r.outputs[n].type){case"audio":var e=r.outputs[n].node,t=l.inputs[a].node;e.connect(t),i.disconnect=function(){e.disconnect(t)};break;case"gateEvent":i.disconnect=r.outputs[n].subscribe(l.inputs[a].notify);break;default:throw new Error("Invalid port type")}})(),updatePatchConnectionList(),updatePatchConnectionValidity()},removeConnection=function(e){var t=cxnInfo[e];t.disconnect(),delete cxnInfo[e],updatePatchConnectionList(),updatePatchConnectionValidity()};patchInputSelectElem.addEventListener("input",function(){updatePatchConnectionValidity()}),patchOutputSelectElem.addEventListener("input",function(){updatePatchConnectionValidity()}),patchConnectButtonElem.addEventListener("click",function(e){e.preventDefault();var t=parseConnectionSpec();if(t)return isValidConnection(t)?void addConnection(t):void console.log("invalid")}),this.windowView.addEventListener("dragover",function(e){e.dataTransfer.dropEffect="copy",e.preventDefault()},!1),this.windowView.addEventListener("drop",function(e){e.preventDefault();var t=e.dataTransfer.getData("text/javascript");addBloc(t)},!1)}return _createClass(Racket,[{key:"save",value:function(){return"foo"}}]),Racket}();exports.default=Racket,Racket.blocName="Racket"},function(e,t){e.exports='<div style="display: flex; flex-direction: column; min-height: 100%; background-color: #222">\n    <div style="font-size: 18px; padding: 5px 10px; color: #ddd; background-color: #666">Racket</div>\n    <div style="flex-grow: 1; display: flex">\n        <div class="bloc-container" style="flex: 1; flex-wrap: wrap; display: flex; align-content: flex-start; padding: 1px"></div>\n        <div style="flex: 0 0 400px; background-color: #444; padding: 10px">\n            <div style="color: #bbb; font-size: 16px; margin-bottom: 10px;">Patch Management</div>\n            <div><select class="patch-output-select"></select> &rarr; <select class="patch-input-select"></select> <button class="patch-connect-button">Connect</button></div>\n            <ul class="patch-connection-list" style="list-style-type: none;padding:0"></ul>\n        </div>\n    </div>\n</div>\n'}]);