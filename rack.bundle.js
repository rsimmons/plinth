!function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function loadRootBlock(code,settings){rootBlockInst&&(rootBlockInst.outputs.audio.node.disconnect(audioContext.destination),rootBlockInst.deactivate&&rootBlockInst.deactivate(),document.querySelector("#root-container").innerHTML=""),rootBlockCode=code,rootBlockClass=eval(code),rootBlockInst=new rootBlockClass(document,audioContext,settings),document.querySelector("#root-container").appendChild(rootBlockInst.windowView),rootBlockInst.outputs.audio.node.connect(audioContext.destination)}function loadEmptyRacket(){loadRootBlock(availableBlockCodes.Racket,void 0)}var _fileSaver=__webpack_require__(6),_fileSaver2=_interopRequireDefault(_fileSaver),availableBlockCodes={BeatClock:__webpack_require__(9),DrumSynth:__webpack_require__(10),Orinami:__webpack_require__(11),Racket:__webpack_require__(12),Waverly:__webpack_require__(13)},blockPaletteElem=document.querySelector("#block-palette"),_loop=function(e){var t=document.createElement("div");t.textContent=e,t.setAttribute("draggable",!0),t.className="block-palette-item",blockPaletteElem.appendChild(t),t.addEventListener("dragstart",function(t){t.dataTransfer.setData("text/javascript",availableBlockCodes[e])},!1)};for(var blockName in availableBlockCodes)_loop(blockName);var audioContext=new(window.AudioContext||window.webkitAudioContext),rootBlockCode=void 0,rootBlockClass=void 0,rootBlockInst=void 0;document.querySelector("#load-racket-button").addEventListener("click",function(e){e.preventDefault(),loadEmptyRacket()}),document.querySelector("#load-preset-button").addEventListener("click",function(e){e.preventDefault();var t=document.querySelector("#load-preset-file-chooser").files;if(t.length<1)return void console.log("no file chosen");var n=t[0],r=new FileReader;r.onload=function(e){var t=e.target.result,n=JSON.parse(t);n.plinthPreset||console.log("not a preset"),loadRootBlock(n.code,n.settings)},r.readAsText(n,"utf-8")}),document.querySelector("#save-preset-button").addEventListener("click",function(e){e.preventDefault();var t=null;rootBlockInst.save?t=rootBlockInst.save():console.log("Loaded block doesn't support saving settings");var n={plinthPreset:"0.1.0",code:rootBlockCode,settings:t},r=JSON.stringify(n);_fileSaver2.default.saveAs(new Blob([r],{type:"application/json;charset=utf-8"}),"preset.json")}),loadEmptyRacket()},,,,,,function(e,t,n){var r,o=o||function(e){"use strict";if(!("undefined"==typeof e||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var t=e.document,n=function(){return e.URL||e.webkitURL||e},r=t.createElementNS("http://www.w3.org/1999/xhtml","a"),o="download"in r,i=function(e){var t=new MouseEvent("click");e.dispatchEvent(t)},a=/constructor/i.test(e.HTMLElement)||e.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent),s=function(t){(e.setImmediate||e.setTimeout)(function(){throw t},0)},c="application/octet-stream",u=4e4,d=function(e){var t=function(){"string"==typeof e?n().revokeObjectURL(e):e.remove()};setTimeout(t,u)},p=function(e,t,n){t=[].concat(t);for(var r=t.length;r--;){var o=e["on"+t[r]];if("function"==typeof o)try{o.call(e,n||e)}catch(e){s(e)}}},f=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e},v=function(t,s,u){u||(t=f(t));var v,h=this,m=t.type,y=m===c,b=function(){p(h,"writestart progress write writeend".split(" "))},k=function(){if((l||y&&a)&&e.FileReader){var r=new FileReader;return r.onloadend=function(){var t=l?r.result:r.result.replace(/^data:[^;]*;/,"data:attachment/file;"),n=e.open(t,"_blank");n||(e.location.href=t),t=void 0,h.readyState=h.DONE,b()},r.readAsDataURL(t),void(h.readyState=h.INIT)}if(v||(v=n().createObjectURL(t)),y)e.location.href=v;else{var o=e.open(v,"_blank");o||(e.location.href=v)}h.readyState=h.DONE,b(),d(v)};return h.readyState=h.INIT,o?(v=n().createObjectURL(t),void setTimeout(function(){r.href=v,r.download=s,i(r),b(),d(v),h.readyState=h.DONE})):void k()},h=v.prototype,m=function(e,t,n){return new v(e,t||e.name||"download",n)};return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(e,t,n){return t=t||e.name||"download",n||(e=f(e)),navigator.msSaveOrOpenBlob(e,t)}:(h.abort=function(){},h.readyState=h.INIT=0,h.WRITING=1,h.DONE=2,h.error=h.onwritestart=h.onprogress=h.onwrite=h.onabort=h.onerror=h.onwriteend=null,m)}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);"undefined"!=typeof e&&e.exports?e.exports.saveAs=o:null!==n(7)&&null!==n(8)&&(r=function(){return o}.call(t,n,t,e),!(void 0!==r&&(e.exports=r)))},function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},function(e,t){(function(t){e.exports=t}).call(t,{})},function(e,t){e.exports='(function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)})([function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var i=n(1),s=r(i);e.exports=s.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(){var e=[],t=function(t){return e.push(t),function(){e.splice(e.indexOf(t),1)}},n=function(t,n){var r=!0,i=!1,s=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var a=o.value;a(t,n)}}catch(e){i=!0,s=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw s}}};return[t,n]}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){var n=[],r=!0,i=!1,s=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,s=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw s}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(2),l=(r(a),n(3)),h=r(l),v=function(){function e(t,n){i(this,e);var r=4,u=[{outName:"gate16",divisor:1},{outName:"gate8",divisor:2},{outName:"gate4",divisor:4}];this.inputs={},this.outputs={};var a=!0,l=!1,v=void 0;try{for(var f,c=u[Symbol.iterator]();!(a=(f=c.next()).done);a=!0){var p=f.value,d=s(),m=o(d,2),y=m[0],_=m[1];this.outputs[p.outName]={type:"gateEvent",subscribe:y},p.emitter=_}}catch(e){l=!0,v=e}finally{try{!a&&c.return&&c.return()}finally{if(l)throw v}}var b=120,g=10,w=t.createElement("div");w.innerHTML=\'<div style="box-sizing: border-box; width: 190px; height: 256px; padding: 5px; background-color: white;"><div>BeatClock</div><form><label>Tempo <input type="number" value="\'+b+\'" min="\'+g+\'" style="width: 50px" />bpm</label></form></div>\',this.panelView=w.childNodes[0],this.panelView.querySelector("input").addEventListener("input",function(e){var t=parseInt(e.target.value,10);!isNaN(t)&&t>=g&&(b=t)},!1),this._scheduler=new h.default(n);var L=n.currentTime+.1,x=0;this._scheduler.start(function(e){for(var t=60/(b*r);L<e.end;){var n=!0,i=!1,s=void 0;try{for(var o,a=u[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value,h=l.divisor,v=h*t;x%h===0&&(l.emitter(L,!0),l.emitter(L+.5*v,!1))}}catch(e){i=!0,s=e}finally{try{!n&&a.return&&a.return()}finally{if(i)throw s}}L+=t,x++}})}return u(e,[{key:"deactivate",value:function(){this._scheduler.stop()}}]),e}();t.default=v,v.blockName="BeatClock"},function(e,t){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(e){return"function"==typeof e}function i(e){return"number"==typeof e}function s(e){return"object"==typeof e&&null!==e}function o(e){return void 0===e}e.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!i(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,n,i,u,a,l;if(this._events||(this._events={}),"error"===e&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;var h=new Error(\'Uncaught, unspecified "error" event. (\'+t+")");throw h.context=t,h}if(n=this._events[e],o(n))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:u=Array.prototype.slice.call(arguments,1),n.apply(this,u)}else if(s(n))for(u=Array.prototype.slice.call(arguments,1),l=n.slice(),i=l.length,a=0;a<i;a++)l[a].apply(this,u);return!0},n.prototype.addListener=function(e,t){var i;if(!r(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,r(t.listener)?t.listener:t),this._events[e]?s(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,s(this._events[e])&&!this._events[e].warned&&(i=o(this._maxListeners)?n.defaultMaxListeners:this._maxListeners,i&&i>0&&this._events[e].length>i&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){function n(){this.removeListener(e,n),i||(i=!0,t.apply(this,arguments))}if(!r(t))throw TypeError("listener must be a function");var i=!1;return n.listener=t,this.on(e,n),this},n.prototype.removeListener=function(e,t){var n,i,o,u;if(!r(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],o=n.length,i=-1,n===t||r(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(s(n)){for(u=o;u-- >0;)if(n[u]===t||n[u].listener&&n[u].listener===t){i=u;break}if(i<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],r(n))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?r(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(r(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(t){n(this,e),this.audioContext=t,this.running=!1,this.timeoutID=null}return r(e,[{key:"start",value:function(e){var t=.05,n=.1,r=this,i=null,s=null,o=function o(){if(!r.running)throw new Error("Internal error: timeoutFunc called but scheduler not running");var u=r.audioContext.currentTime;null===i&&(i=u,s=u),s<u&&console.log("FELL BEHIND BY",u-s);var a=u+n;e({begin:s,end:a,relativeBegin:s-i,relativeEnd:a-i,start:i}),s=a,r.timeoutID=setTimeout(o,1e3*t)};this.running=!0,o()}},{key:"stop",value:function(){this.running=!1,this.timeoutID&&(clearTimeout(this.timeoutID),this.timeoutID=null)}}]),e}();t.default=i}]);'},function(e,t){e.exports='(function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)})([function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var i=n(1),o=r(i);e.exports=o.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(t,r){n(this,e);var i=1,o=440,a=.1,u=!1,s=function(e,t){t&&!u&&(c.frequency.setValueAtTime(o,e),c.frequency.exponentialRampToValueAtTime(i,e+a)),u=t},c=r.createOscillator();c.type="sine",c.frequency.value=i,c.start(),this.inputs={gate:{type:"gateEvent",notify:s}},this.outputs={audio:{type:"audio",node:c}};var l=t.createElement("div");l.innerHTML=\'<div style="box-sizing: border-box; width: 126px; height: 256px; padding: 5px; background-color: white;">DrumSynth</div>\',this.panelView=l.childNodes[0]};t.default=r,r.blockName="DrumSynth"}]);'},function(e,t){e.exports='(function(e){function t(n){if(i[n])return i[n].exports;var a=i[n]={exports:{},id:n,loaded:!1};return e[n].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var i={};return t.m=e,t.c=i,t.p="",t(0)})([function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var a=i(1),r=n(a);e.exports=r.default},function(e,t){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function e(t,n){i(this,e);var a=0,r=4,o=void 0,u=n.createGain();u.gain.value=1;var d=n.createWaveShaper();d.oversample="none",u.connect(d);var s=function(e){for(var t=2*(e+1),i=new Float32Array(t),n=0;n<t;n++)i[n]=(e+n)%2?1:-1;d.curve=i,o=1/(t-1)};s(r),this.inputs={audio:{type:"audio",node:u}},this.outputs={audio:{type:"audio",node:d}};var l=t.createElement("div");l.innerHTML=\'<div style="box-sizing: border-box; width: 126px; height: 256px; padding: 5px; background-color: white;"><div>Orinami</div><div><label>Stages <input type="number" value="\'+r+\'" min="\'+a+\'" step="1" style="width: 50px" /></label></div></div>\',this.panelView=l.childNodes[0],this.panelView.querySelector("input").addEventListener("input",function(e){var t=parseInt(e.target.value,10);if(!isNaN(t)){var i=Math.floor(t);i>=a&&s(i)}},!1)};t.default=n,n.blockName="Orinami"}]);'},function(e,t){e.exports='(function(t){function e(n){if(o[n])return o[n].exports;var r=o[n]={exports:{},id:n,loaded:!1};return t[n].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var o={};return e.m=t,e.c=o,e.p="",e(0)})([function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}var r=o(1),a=n(r);t.exports=a.default},function(module,exports,__webpack_require__){"use strict";function _toConsumableArray(t){if(Array.isArray(t)){for(var e=0,o=Array(t.length);e<t.length;e++)o[e]=t[e];return o}return Array.from(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function removeChildren(t){for(;t.firstChild;)t.removeChild(t.firstChild)}Object.defineProperty(exports,"__esModule",{value:!0});var _slicedToArray=function(){function t(t,e){var o=[],n=!0,r=!1,a=void 0;try{for(var i,c=t[Symbol.iterator]();!(n=(i=c.next()).done)&&(o.push(i.value),!e||o.length!==e);n=!0);}catch(t){r=!0,a=t}finally{try{!n&&c.return&&c.return()}finally{if(r)throw a}}return o}return function(e,o){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,o);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_createClass=function(){function t(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,o,n){return o&&t(e.prototype,o),n&&t(e,n),e}}(),template=__webpack_require__(2),Racket=function(){function Racket(document,audioContext,settings){var _this=this;_classCallCheck(this,Racket),this.inputs={},this.outputs={};var tmpElem=document.createElement("div");tmpElem.innerHTML=template,this.windowView=tmpElem.childNodes[0];var blockContainerElem=this.windowView.querySelector(".block-container"),patchInputSelectElem=this.windowView.querySelector(".patch-input-select"),patchOutputSelectElem=this.windowView.querySelector(".patch-output-select"),patchConnectButtonElem=this.windowView.querySelector(".patch-connect-button"),patchConnectionListElem=this.windowView.querySelector(".patch-connection-list"),rackInputPseudoblock={outputs:{}},rackOutputPseudoblock={inputs:{}},nextBlockIdNum=1,blockInfo={ri:{id:"ri",code:null,_class:null,instance:rackInputPseudoblock,displayName:"RACK INPUT"},ro:{id:"ro",code:null,_class:null,instance:rackOutputPseudoblock,displayName:"RACK OUTPUT"}},pseudoblockIds=new Set(["ri","ro"]),nextCxnIdNum=1,cxnInfo={},updatePatchConnectionList=function(){removeChildren(patchConnectionListElem);var t=function(t){var e=cxnInfo[t],o=blockInfo[e.outBlockId].displayName+":"+e.outPortName+" → "+blockInfo[e.inBlockId].displayName+":"+e.inPortName,n=document.createElement("li");n.appendChild(document.createTextNode(o+" "));var r=document.createElement("button");r.textContent="remove",r.addEventListener("click",function(){removeConnection(t)}),n.appendChild(r),patchConnectionListElem.appendChild(n)};for(var e in cxnInfo)t(e)},isValidConnection=function(t){var e=t.outBlockId,o=t.outPortName,n=t.inBlockId,r=t.inPortName,a=blockInfo[e].instance,i=blockInfo[n].instance;if(!a.outputs.hasOwnProperty(o))return!1;if(!i.inputs.hasOwnProperty(r))return!1;for(var c in cxnInfo){var l=cxnInfo[c];if(l.outBlockId===e&&l.outPortName===o&&l.inBlockId===n&&l.inPortName===r)return!1}return a.outputs[o].type===i.inputs[r].type},parseConnectionSpec=function(){var t=patchInputSelectElem.value,e=patchOutputSelectElem.value;if(!t||!e)return null;var o=t.split(":"),n=_slicedToArray(o,2),r=n[0],a=n[1],i=e.split(":"),c=_slicedToArray(i,2),l=c[0],d=c[1];return{inBlockId:r,inPortName:a,outBlockId:l,outPortName:d}},updatePatchConnectionValidity=function(){var t=parseConnectionSpec();patchConnectButtonElem.disabled=!(t&&isValidConnection(t))},updatePatchConnectOptions=function(){var t={},e={};for(var o in blockInfo){var n=blockInfo[o].instance,r=blockInfo[o].displayName;for(var a in n.inputs)t[o+":"+a]=r+":"+a;for(var i in n.outputs)e[o+":"+i]=r+":"+i}removeChildren(patchInputSelectElem);for(var c in t){var l=document.createElement("option");l.textContent=t[c]+" IN",l.value=c,patchInputSelectElem.appendChild(l)}removeChildren(patchOutputSelectElem);for(var d in e){var l=document.createElement("option");l.textContent=e[d]+" OUT",l.value=d,patchOutputSelectElem.appendChild(l)}updatePatchConnectionValidity()},uniquifyDisplayName=function(t){var e=blockInfo[t].displayName,o={};for(var n in blockInfo)n!==t&&(o[blockInfo[n].displayName]=null);if(o.hasOwnProperty(e))for(var r=2;;r++){var a=e+" "+r;if(!o.hasOwnProperty(a))return void(blockInfo[t].displayName=a)}},addBlock=function addBlock(code,settings,displayName){var bid="b"+nextBlockIdNum;nextBlockIdNum++;var blockClass=eval(code),blockInst=new blockClass(document,audioContext,settings);blockInfo[bid]={id:bid,code:code,_class:blockClass,instance:blockInst,displayName:displayName||blockClass.blockName,wrapperElem:void 0},uniquifyDisplayName(bid);var wrapperElem=document.createElement("div");wrapperElem.style="margin: 1px",wrapperElem.setAttribute("data-blockid",bid);var headerElem=document.createElement("div");headerElem.style="background-color: #555; font-size: 12px; padding: 4px 6px; color: #ccc";var removeBlockElem=document.createElement("a");if(removeBlockElem.style="float:right;color: #ccc;text-decoration: none",removeBlockElem.href="#",removeBlockElem.textContent="X",removeBlockElem.addEventListener("click",function(t){t.preventDefault(),removeBlock(bid)}),headerElem.appendChild(removeBlockElem),headerElem.appendChild(document.createTextNode(blockInfo[bid].displayName)),wrapperElem.appendChild(headerElem),blockInst.panelView)wrapperElem.appendChild(blockInst.panelView);else{var placeholderElem=document.createElement("div");placeholderElem.innerHTML=\'<div style="box-sizing:border-box;width:62px;height:256px;text-align:center;font-size:14px;background:white;font-style:italic;color:gray;padding:100px 5px">No panel view</div>\',wrapperElem.appendChild(placeholderElem)}blockContainerElem.appendChild(wrapperElem),blockInfo[bid].wrapperElem=wrapperElem,updatePatchConnectOptions()},removeBlock=function(t){var e=[];for(var o in cxnInfo){var n=cxnInfo[o];n.outBlockId!==t&&n.inBlockId!==t||e.push(o)}var r=!0,a=!1,i=void 0;try{for(var c,l=e[Symbol.iterator]();!(r=(c=l.next()).done);r=!0){var d=c.value;removeConnection(d)}}catch(t){a=!0,i=t}finally{try{!r&&l.return&&l.return()}finally{if(a)throw i}}blockContainerElem.removeChild(blockInfo[t].wrapperElem);var s=blockInfo[t].instance;s.deactivate&&s.deactivate(),delete blockInfo[t],updatePatchConnectOptions()},addRackInput=function(t,e){if(_this.inputs[t])throw new Error("port name already exists");switch(e){case"audio":var o=audioContext.createGain();_this.inputs[t]={type:"audio",node:o},rackInputPseudoblock.outputs[t]={type:"audio",node:o};break;default:throw new Error("Unsupported rack port type")}},addRackOutput=function(t,e){if(_this.outputs[t])throw new Error("port name already exists");switch(e){case"audio":var o=audioContext.createGain();_this.outputs[t]={type:"audio",node:o},rackOutputPseudoblock.inputs[t]={type:"audio",node:o};break;default:throw new Error("Unsupported rack port type")}},addConnection=function(t){var e=t.outBlockId,o=t.outPortName,n=t.inBlockId,r=t.inPortName,a="c"+nextCxnIdNum;nextCxnIdNum++;var i={outBlockId:e,outPortName:o,inBlockId:n,inPortName:r,disconnect:void 0};cxnInfo[a]=i;var c=blockInfo[e].instance,l=blockInfo[n].instance;(function(){switch(c.outputs[o].type){case"audio":var t=c.outputs[o].node,e=l.inputs[r].node;t.connect(e),i.disconnect=function(){t.disconnect(e)};break;case"gateEvent":i.disconnect=c.outputs[o].subscribe(l.inputs[r].notify);break;default:throw new Error("Invalid port type")}})(),updatePatchConnectionList(),updatePatchConnectionValidity()},removeConnection=function(t){var e=cxnInfo[t];e.disconnect(),delete cxnInfo[t],updatePatchConnectionList(),updatePatchConnectionValidity()};if(patchInputSelectElem.addEventListener("input",function(){updatePatchConnectionValidity()}),patchOutputSelectElem.addEventListener("input",function(){updatePatchConnectionValidity()}),patchConnectButtonElem.addEventListener("click",function(t){t.preventDefault();var e=parseConnectionSpec();if(e)return isValidConnection(e)?void addConnection(e):void console.log("invalid")}),this.windowView.addEventListener("dragover",function(t){t.dataTransfer.dropEffect="copy",t.preventDefault()},!1),this.windowView.addEventListener("drop",function(t){t.preventDefault();var e=t.dataTransfer.getData("text/javascript");addBlock(e)},!1),settings){var settingsObj=JSON.parse(settings),codeMap=new Map(settingsObj.codeMap),_iteratorNormalCompletion2=!0,_didIteratorError2=!1,_iteratorError2=void 0;try{for(var _iterator2=settingsObj.blockOrder[Symbol.iterator](),_step2;!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=!0){var bid=_step2.value,binfo=settingsObj.blockMap[bid];addBlock(codeMap.get(binfo.codeId),binfo.settings,binfo.displayName)}}catch(t){_didIteratorError2=!0,_iteratorError2=t}finally{try{!_iteratorNormalCompletion2&&_iterator2.return&&_iterator2.return()}finally{if(_didIteratorError2)throw _iteratorError2}}for(var pn in settingsObj.rackInputPorts)addRackInput(pn,settingsObj.rackInputPorts[pn].type);for(var _pn4 in settingsObj.rackOutputPorts)addRackOutput(_pn4,settingsObj.rackOutputPorts[_pn4].type);var _iteratorNormalCompletion3=!0,_didIteratorError3=!1,_iteratorError3=void 0;try{for(var _iterator3=settingsObj.connections[Symbol.iterator](),_step3;!(_iteratorNormalCompletion3=(_step3=_iterator3.next()).done);_iteratorNormalCompletion3=!0){var cxn=_step3.value;addConnection(cxn)}}catch(t){_didIteratorError3=!0,_iteratorError3=t}finally{try{!_iteratorNormalCompletion3&&_iterator3.return&&_iterator3.return()}finally{if(_didIteratorError3)throw _iteratorError3}}}else addRackOutput("audio","audio");updatePatchConnectionValidity(),updatePatchConnectOptions(),this.blockInfo=blockInfo,this.pseudoblockIds=pseudoblockIds,this.blockContainerElem=blockContainerElem,this.cxnInfo=cxnInfo,this.rackInputPseudoblock=rackInputPseudoblock,this.rackOutputPseudoblock=rackOutputPseudoblock}return _createClass(Racket,[{key:"save",value:function(){var t=new Map,e=1;for(var o in this.blockInfo)if(!this.pseudoblockIds.has(o)){var n=this.blockInfo[o];t.has(n.code)||(t.set(n.code,e),e++)}var r=new Map,a=!0,i=!1,c=void 0;try{for(var l,d=t[Symbol.iterator]();!(a=(l=d.next()).done);a=!0){var s=_slicedToArray(l.value,2),u=s[0],p=s[1];r.set(p,u)}}catch(t){i=!0,c=t}finally{try{!a&&d.return&&d.return()}finally{if(i)throw c}}var f={};for(var m in this.blockInfo)if(!this.pseudoblockIds.has(m)){var v=this.blockInfo[m];f[m]={codeId:t.get(v.code),settings:v.instance.save?v.instance.save():null,displayName:v.displayName}}var k=[],h=!0,b=!1,y=void 0;try{for(var I,C=this.blockContainerElem.childNodes[Symbol.iterator]();!(h=(I=C.next()).done);h=!0){var E=I.value,x=E.dataset.blockid;if(!x||!f[x])throw new Error("internal error");k.push(E.dataset.blockid)}}catch(t){b=!0,y=t}finally{try{!h&&C.return&&C.return()}finally{if(b)throw y}}var w=[];for(var _ in this.cxnInfo){var P=this.cxnInfo[_];w.push({outBlockId:P.outBlockId,outPortName:P.outPortName,inBlockId:P.inBlockId,inPortName:P.inPortName})}var N={};for(var g in this.rackInputPseudoblock.outputs){var O=this.rackInputPseudoblock.outputs[g];N[g]={type:O.type}}var B={};for(var S in this.rackOutputPseudoblock.inputs){var V=this.rackOutputPseudoblock.inputs[S];B[S]={type:V.type}}return JSON.stringify({codeMap:[].concat(_toConsumableArray(r)),blockMap:f,blockOrder:k,connections:w,rackInputPorts:N,rackOutputPorts:B})}}]),Racket}();exports.default=Racket,Racket.blockName="Racket"},function(t,e){t.exports=\'<div style="display: flex; flex-direction: column; min-height: 100%; background-color: #222">\\n    <div style="font-size: 18px; padding: 5px 10px; color: #ddd; background-color: #666">Racket</div>\\n    <div style="flex-grow: 1; display: flex">\\n        <div class="block-container" style="flex: 1; flex-wrap: wrap; display: flex; align-content: flex-start; padding: 1px"></div>\\n        <div style="flex: 0 0 400px; background-color: #444; padding: 10px">\\n            <div style="color: #bbb; font-size: 16px; margin-bottom: 10px;">Patch Management</div>\\n            <div><select class="patch-output-select"></select> &rarr; <select class="patch-input-select"></select> <button class="patch-connect-button">Connect</button></div>\\n            <ul class="patch-connection-list" style="list-style-type: none;padding:0"></ul>\\n        </div>\\n    </div>\\n</div>\\n\'}]);'},function(e,t){e.exports='(function(e){function t(i){if(n[i])return n[i].exports;var a=n[i]={exports:{},id:i,loaded:!1};return e[i].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)})([function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a);e.exports=r.default},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),r=function e(t,n){i(this,e);var r="sine",l=440,o=100,u=n.createOscillator();u.type=r,u.frequency.value=l,u.start();var s=n.createGain();s.gain.value=o,s.connect(u.frequency),this.inputs={fm:{type:"audio",node:s}},this.outputs={audio:{type:"audio",node:u}};var p=t.createElement("div");p.innerHTML=a,this.panelView=p.childNodes[0];var c=this.panelView.querySelector(".waveform-select");c.value=r,c.addEventListener("input",function(){u.type=c.value});var v=this.panelView.querySelector(".frequency-input");v.value=l,v.addEventListener("input",function(){var e=parseInt(v.value,10);e>0&&(u.frequency.value=e)});var d=this.panelView.querySelector(".fm-scale-input");d.value=o,d.addEventListener("input",function(){var e=parseInt(d.value,10);s.gain.value=e})};t.default=r,r.blockName="Waverly"},function(e,t){e.exports=\'<div style="box-sizing: border-box; width: 126px; height: 256px; padding: 10px; background-color: #dfe3eb;">\\n    <div style="text-align: center; font-family: monospace;color: #415274">\\\\/\\\\/averly</div>\\n    <div style="font-size: 14px;margin-top:20px">\\n        <label>Form<br><select class="waveform-select">\\n            <option value="sine">SIN</option>\\n            <option value="triangle">TRI</option>\\n            <option value="square">SQR</option>\\n            <option value="sawtooth">SAW</option>\\n        </select></label>\\n        <div style="margin-top:10px;"><label>Frequency<br><input class="frequency-input" type="number" style="width: 5em;text-align:right">hz</label></div>\\n        <div style="margin-top:10px;"><label>FM Scale<br><input class="fm-scale-input" type="number" style="width: 5em;text-align:right"></label></div>\\n    </div>\\n</div>\\n\'}]);'}]);